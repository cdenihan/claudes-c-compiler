Fix remaining i686 project failures
=====================================
Date: 2026-01-28 (updated after rep movsb callee-save fix)

Current status:
- Unit tests: ~99.2% pass (10% sample: 2716/2737)
- Projects passing: 5/12 (zlib, lua, libpng, jq, libuv)
- Projects failing: libsodium, mquickjs, libjpeg, mbedtls, libffi, musl, tcc

Fixed in latest round (rep movsb callee-save fix):
- emit_memcpy now always saves/restores ESI and EDI around rep movsb
- Previously only saved them if they were register-allocated in the function
- This violated the callee-saved ABI contract and caused widespread crashes
- jq: went from 1/12 pass to 12/12 pass (was SIGABRT/SIGSEGV on every test)
- lua: now passes (was failing due to same callee-save corruption)
- libpng: now passes (same root cause)

Known remaining issues:

1. mquickjs crashes with SIGSEGV
   - All test_*.js tests segfault
   - Need to debug under GDB to find specific crash point

2. musl: Build fails during assembly of i386 math routines
   - Error in src/math/i386/scalblnf.s (inline asm)
   - May need i686-specific inline assembly handling

3. tcc: Build/test failures

4. libffi: Build fails (needs i686-specific handling)

5. mbedtls: Build fails (__builtin_ia32_pshufd not implemented)

6. libsodium: Timeouts and segfaults

7. libjpeg: Test failures

Priority investigation targets:
- mquickjs (JS engine, exercises many codegen paths)
- musl inline asm for i386 math routines
- mbedtls SSE2 intrinsic builtins

Techniques:
- Compare i686 assembly output against i686-linux-gnu-gcc for suspect functions
- Use GDB to trace execution and find divergence points
- Run unit test suite to find specific failing test categories
