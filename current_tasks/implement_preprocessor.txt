Implement preprocessor improvements: ##__VA_ARGS__ GNU extension and __has_attribute
